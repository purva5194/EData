<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/canvasjs/1.7.0/canvasjs.min.js"></script>
	<link rel="stylesheet" type="text/css" href="style/style.css" />	
	<script type="text/javascript">
        var dept = [];
        var number = [];

 function fetch_data() {
    var jsonData = $.ajax({
      url: 'department_query.php',
        dataType:"json",
        async: false,
      success: function(jsonData)
        {
                for(var i=0; i<9; i++)
                {
                        dept[i] = jsonData[i+1][0];
                        number[i] = jsonData[i+1][1];
                }
                //console.log(jsonData[1][0]);
                console.log(dept);
                console.log(number);
        }
      }).responseText;
}

 window.onload = function () {

fetch_data();
    
var chart = new CanvasJS.Chart("chartContainer",
	{
		title:{
			text: "Number of Employees in Each Department"
		},
		legend: {
			maxWidth: 350,
			itemWidth: 120
		},
		data: [
		{
			type: "pie",
			showInLegend: true,
			legendText: "{indexLabel}",
			dataPoints: [
				{ y: number[0], indexLabel: dept[0] },
				{ y: number[1], indexLabel: dept[1]},
				{ y: number[2], indexLabel: dept[2] },
				{ y: number[3], indexLabel: dept[3]},
				{ y: number[4], indexLabel: dept[4] },
				{ y: number[5], indexLabel: dept[5]},
				{ y: number[6], indexLabel: dept[6]},
                                { y: number[7], indexLabel: dept[7]},
                                { y: number[8], indexLabel: dept[8]}
			]
		}
		]
	});
	chart.render();      	
  }
</script>

  </head>
	<body> 
   	 <div id="main">
    <div id="header">
      <div id="logo">
        <div id="logo_text">
          <!-- class="logo_colour", allows you to change the colour of the text -->
          <h1><a href="index.html">Employee<span class="logo_colour">Data</span></a></h1>
       </div>
      </div>
<div id="menubar">
        <ul id="menu">
          <!-- put class="selected" in the li tag for the selected page - to highlight which page you're on -->
          <li><a href="gender.html">Employees</a></li> <!-- M vs F column Chart gender.html-->
          <li><a href="department.html">Department </a></li> <!-- Pie chart department.html -->
          <li><a href="title.html">Employees Job Title</a></li> <!-- title.html -->
          <li><a href="year.html">Yearly Hired</a></li>
	  <li><a href="http://ec2-34-224-7-47.compute-1.amazonaws.com:8080/">Jenkins</a></li>
	  <li><a href="http://ec2-34-224-7-47.compute-1.amazonaws.com:3000/">Log Out</a></li>          
        </ul>
      </div>
</div>
	<div>
	<br><br><br><br>
	<center> <div id="chartContainer" style="height: 500px; width: 50%;"></div> </center>
     </div>
	</div>
   </div>
        </body>
  <script type="text/javascript">
      
    </script>
</html>

